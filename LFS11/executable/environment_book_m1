#!/bin/bash
# bash without -i resets PS1
# except for the log file variables this comes from section 4.4

script="$@"
if [[ -z "$script" ]]; then
  script="/bin/bash --norc"
fi

# we will use our local version of Z so that it will be found after the chroot
# copied from .bashrc /usr/bin/Z -> Z
# might be better to include Z in the m1 build so it is still /usr/local/bin/Z on m2
PPS1='\n$(Z)[$PROJECT]\n\u@\hยง$(pwd)ยง\n> '
PS1="$PPS1"

M2_ROOT="/mnt/m2_root"
LFS_BUILD_DIR="$REPO_HOME/LFS/LFS11"
env -i "$LFS_BUILD_DIR/executable/environment_book_m1-1"\
  "$PPS1"\
  "$PPS2"\
  "$REPO_HOME"\
  "$PROJECT_HOME"\
  "$PROJECT"\
  "$LFS_BUILD_DIR"\
  "$M2_ROOT"\
  "$FRAME_LOG"\
  "$BUILD_LOG"\
  $script
